{% extends "delivery/base.html" %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='delivery/delivery_styles.css') }}">
<style>
      /* è¡¨æ ¼æ‰€æœ‰å•å…ƒæ ¼ä¸æ¢è¡Œ */
      .delivery-table th,
      .delivery-table td {
        white-space: nowrap;   /* ç¦æ­¢è‡ªåŠ¨æ¢è¡Œ */
        vertical-align: middle; /* è®©å†…å®¹å‚ç›´å±…ä¸­ï¼Œå¯é€‰ */
      }

      .delivery-card {
        width: 100%;
      }
</style>
{% endblock %}


{% block content %}
<div class="form-title-container">
    <h1 class="form-title">ğŸ“¦ æ‹£è´§ç®¡ç†</h1>
</div>

<div class="delivery-card animate-fade">
<!-- æŸ¥è¯¢è¡¨å• -->
  <form method="get" class="row g-3 query-form align-items-end">
      {{ form.csrf_token }}

      <div class="col-md-2">
        {{ form.delivery_id.label(class="form-label") }}
        {{ form.delivery_id(class="form-control", placeholder="å‘è´§å•å·") }}
      </div>

      <div class="col-md-2">
        {{ form.sales_order_id.label(class="form-label") }}
        {{ form.sales_order_id(class="form-control", placeholder="é”€å”®è®¢å•å·") }}
      </div>

      <div class="col-md-2">
        {{ form.status.label(class="form-label") }}
        {{ form.status(class="form-select") }}
      </div>

      <div class="col-md-2">
        {{ form.start_date.label(class="form-label") }}
        {{ form.start_date(class="form-control", type="date") }}
      </div>

      <div class="col-md-2">
        {{ form.end_date.label(class="form-label") }}
        {{ form.end_date(class="form-control", type="date") }}
      </div>

      <div class="col-md-2">
        {{ form.submit(class="btn btn-search w-100") }}
      </div>
  </form>
</div>



<div class="card shadow-sm">
    <div class="card-body">
      <div class="table-responsive">
        <table class="table table-hover align-middle">
          <thead class="thead-light">
            <tr>
              <th>ä»»åŠ¡ç¼–å·</th>
              <th>é”€å”®è®¢å•</th>
              <th>ä»“åº“</th>
              <th>çŠ¶æ€</th>
              <th>æ‹£è´§å‘˜</th>
              <th>å¼€å§‹æ—¶é—´</th>
              <th>å®Œæˆæ—¶é—´</th>
              <th>å…³è”å‘è´§å•</th>
            </tr>
          </thead>
          <tbody>
            {% for row in rows %}
            {% set task = row.task %}
            {% set delivery = row.delivery %}
            <tr>
              <td>
                <a href="{{ url_for('delivery.picking_task_detail', task_id=task.task_id) }}">
                  {{ task.task_id }}
                </a>
              </td>
              <td>{{ task.sales_order_id }}</td>
              <td>{{ task.warehouse_code }}</td>
              <td>
                <span class="badge
                  {% if task.status == 'å¾…æ‹£è´§' %}bg-warning
                  {% elif task.status == 'å·²å®Œæˆ' %}bg-success
                  {% else %}bg-danger{% endif %}">
                  {{ task.status }}
                </span>
              </td>
              <td>{{ task.picker or '-' }}</td>
              <td>{{ task.start_time.strftime('%Y-%m-%d %H:%M') if task.start_time else '-' }}</td>
              <td>{{ task.complete_time.strftime('%Y-%m-%d %H:%M') if task.complete_time else '-' }}</td>
              <td>
                {% if delivery %}
                  <a href="{{ url_for('delivery.picking_task_detail', task_id=task.task_id) }}">
                    {{ delivery.delivery_note_id }}
                  </a>
                {% else %}
                  -
                {% endif %}
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="8" class="text-center">æš‚æ— æ‹£è´§ä»»åŠ¡</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% endblock %}
